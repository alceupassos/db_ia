module.exports=[18622,(e,a,r)=>{a.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,a,r)=>{a.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,a,r)=>{a.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,a,r)=>{a.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,a,r)=>{a.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},837,(e,a,r)=>{"use strict";a.exports=e.r(70782).vendored["react-rsc"].ReactServerDOMTurbopackServer},68250,(e,a,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"registerServerReference",{enumerable:!0,get:function(){return t.registerServerReference}});let t=e.r(837)},70495,(e,a,r)=>{"use strict";function t(e){for(let a=0;a<e.length;a++){let r=e[a];if("function"!=typeof r)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureServerEntryExports",{enumerable:!0,get:function(){return t}})},79292,e=>{"use strict";var a=e.i(68250),r=e.i(68937),t=e.i(70495);let n=(0,r.createClient)("https://uoqzxsfdxlqpbujsklfn.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function s(e){let a=n.from("demandas_juridicas").select("*").order("data_solicitacao",{ascending:!1,nullsFirst:!1});e?.status&&"all"!==e.status&&(a=a.eq("status",e.status)),e?.responsavel&&"all"!==e.responsavel&&(a=a.eq("responsavel",e.responsavel)),e?.cliente&&"all"!==e.cliente&&(a=a.eq("cliente_nome",e.cliente)),e?.search&&(a=a.or(`demanda.ilike.%${e.search}%,cliente_nome.ilike.%${e.search}%,observacoes.ilike.%${e.search}%`));let{data:r,error:t}=await a;if(t)throw t;return r}async function i(e){let{data:a,error:r}=await n.from("demandas_juridicas").select("*").eq("id",e).single();if(r)throw r;return a}async function o(e){let{data:a,error:r}=await n.from("demandas_juridicas").insert(e).select().single();if(r)throw r;return a}async function c(e,a){let{data:r,error:t}=await n.from("demandas_juridicas").update(a).eq("id",e).select().single();if(t)throw t;return r}async function d(e){let{error:a}=await n.from("demandas_juridicas").delete().eq("id",e);if(a)throw a}async function l(){let{data:e}=await n.from("demandas_juridicas").select("status");if(!e)return{total:0,pendentes:0,emAndamento:0,concluidos:0};let a=e.length,r=e.filter(e=>"PENDENTE"===e.status).length;return{total:a,pendentes:r,emAndamento:e.filter(e=>"EM ANDAMENTO"===e.status).length,concluidos:e.filter(e=>"CONCLUÍDO"===e.status).length}}async function u(){let{data:e,error:a}=await n.from("demandas_juridicas").select("responsavel").order("responsavel");if(a)throw a;return[...new Set(e.map(e=>e.responsavel))].filter(Boolean)}async function f(){let{data:e,error:a}=await n.from("demandas_juridicas").select("cliente_nome").order("cliente_nome");if(a)throw a;return[...new Set(e.map(e=>e.cliente_nome))].filter(Boolean)}async function m(e){let{data:a,error:r}=await n.from("arquivos_demanda").select("*").eq("demanda_id",e).order("created_at",{ascending:!1});if(r)throw r;return a}async function p(e,a){let{data:r,error:t}=await n.from("arquivos_demanda").insert({demanda_id:e,...a}).select().single();if(t)throw t;return r}async function _(e,a,r){let{data:t,error:s}=await n.from("demandas_juridicas").update({[a]:r}).eq("id",e).select().single();if(s)throw s;return t}async function v(e){let{error:a}=await n.from("arquivos_demanda").delete().eq("id",e);if(a)throw a}async function b(e,a){let{data:r,error:t}=await n.from("arquivos_demanda").update(a).eq("id",e).select().single();if(t)throw t;return r}async function g(e,a){let r=a.get("file");if(!r)throw Error("Nenhum arquivo enviado");let t=`${e}/${Date.now()}-${r.name}`,{data:s,error:i}=await n.storage.from("arquivos-juridico").upload(t,r,{cacheControl:"3600",upsert:!1});if(i)throw i;let{data:o}=n.storage.from("arquivos-juridico").getPublicUrl(t),{data:c,error:d}=await n.from("arquivos_demanda").insert({demanda_id:e,nome:r.name,tipo:r.type.split("/")[1]?.toUpperCase()||"ARQUIVO",mime_type:r.type,supabase_path:s.path,storage_url:o.publicUrl}).select().single();if(d)throw d;try{let e=process.env.NEXT_PUBLIC_APP_URL||process.env.VERCEL_URL?`https://${process.env.VERCEL_URL}`:"http://localhost:3000",a=await fetch(`${e}/api/juridico/analisar-arquivo`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({arquivoId:c.id,arquivoNome:r.name,storageUrl:o.publicUrl,mimeType:r.type})});a.ok||console.warn("Análise de arquivo retornou erro:",a.status)}catch(e){console.error("Erro ao analisar arquivo com IA:",e)}return c}async function w(e){let{data:a,error:r}=await n.from("arquivos_demanda").select("supabase_path").eq("id",e).single();if(r)throw r;a?.supabase_path&&await n.storage.from("arquivos-juridico").remove([a.supabase_path]);let{error:t}=await n.from("arquivos_demanda").delete().eq("id",e);if(t)throw t}async function h(){let{data:e,error:a}=await n.from("demandas_juridicas").select("status");if(a)throw a;let r={PENDENTE:0,"EM ANDAMENTO":0,CONCLUÍDO:0,Cancelado:0};return e?.forEach(e=>{e.status in r&&r[e.status]++}),Object.entries(r).map(([e,a])=>({status:e,count:a}))}async function y(){let{data:e,error:a}=await n.from("demandas_juridicas").select("cliente_nome");if(a)throw a;let r={};return e?.forEach(e=>{let a=e.cliente_nome||"Sem cliente";r[a]=(r[a]||0)+1}),Object.entries(r).map(([e,a])=>({cliente:e,count:a})).sort((e,a)=>a.count-e.count).slice(0,10)}async function S(){let{data:e,error:a}=await n.from("arquivos_demanda").select("categoria");if(a)throw a;let r={};return e?.forEach(e=>{let a=e.categoria||"Sem categoria";r[a]=(r[a]||0)+1}),Object.entries(r).map(([e,a])=>({categoria:e,count:a}))}async function q(){let{data:e,error:a}=await n.from("demandas_juridicas").select("created_at, status").order("created_at",{ascending:!0});if(a)throw a;let r={};return e?.forEach(e=>{if(!e.created_at)return;let a=new Date(e.created_at),t=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`;r[t]||(r[t]={criadas:0,concluidas:0}),r[t].criadas++,"CONCLUÍDO"===e.status&&r[t].concluidas++}),Object.entries(r).map(([e,a])=>({mes:e,...a})).slice(-12)}async function R(e=20){let{data:a,error:r}=await n.from("demandas_juridicas").select("id, demanda, status, created_at, updated_at, cliente_nome").order("updated_at",{ascending:!1}).limit(e);if(r)throw r;return a?.map(e=>({id:e.id,tipo:"demanda",titulo:e.demanda,cliente:e.cliente_nome,status:e.status,data:e.updated_at||e.created_at,descricao:`Status: ${e.status}`}))||[]}async function E(){let e=new Date;e.setHours(0,0,0,0);let{data:a,error:r}=await n.from("demandas_juridicas").select("id, demanda, cliente_nome, prazo, data_entrega, data_fim_contrato, data_pagamento").or("prazo.is.not.null,data_entrega.is.not.null,data_fim_contrato.is.not.null,data_pagamento.is.not.null");if(r)throw r;let t=[];return a?.forEach(a=>{let r=(r,n,s)=>{let i=a[r];if(!i)return;let o=new Date(i);if(o.setHours(0,0,0,0),o>=e){let c=Math.ceil((o.getTime()-e.getTime())/864e5);if(c<=7){let e="baixa";c<=1?e="alta":c<=3&&(e="media"),t.push({id:`${a.id}-${r}`,tipo:n,titulo:`${s}: ${a.demanda}`,descricao:`Cliente: ${a.cliente_nome}`,data:i,diasRestantes:c,urgencia:e})}}};r("prazo","prazo","Prazo"),r("data_entrega","entrega","Data de Entrega"),r("data_fim_contrato","fim_contrato","Fim de Contrato"),r("data_pagamento","pagamento","Data de Pagamento")}),t.sort((e,a)=>e.diasRestantes-a.diasRestantes)}async function j(e,a,r,t){let{data:s}=await n.from("arquivos_demanda").select("status_aprovacao").eq("id",e).single(),i=s?.status_aprovacao||"RASCUNHO",{data:o,error:c}=await n.from("arquivos_demanda").update({status_aprovacao:a,aprovado_por:t||null,aprovado_em:new Date().toISOString(),comentarios_aprovacao:r||null}).eq("id",e).select().single();if(c)throw c;return await n.from("historico_aprovacoes").insert({arquivo_id:e,status_anterior:i,status_novo:a,comentario:r||null,aprovado_por:t||null}),o}async function x(e){let{data:a,error:r}=await n.from("arquivos_demanda").update({status_aprovacao:"EM_REVISAO"}).eq("id",e).select().single();if(r)throw r;return await n.from("historico_aprovacoes").insert({arquivo_id:e,status_anterior:"RASCUNHO",status_novo:"EM_REVISAO"}),a}async function O(e){let{data:a,error:r}=await n.from("historico_aprovacoes").select("*").eq("arquivo_id",e).order("created_at",{ascending:!1});if(r)throw r;return a}(0,t.ensureServerEntryExports)([s,i,o,c,d,l,u,f,m,p,_,v,b,g,w,h,y,S,q,R,E,j,x,O]),(0,a.registerServerReference)(s,"404b748f0b1946809009224a95532ef6f14a9fe75e",null),(0,a.registerServerReference)(i,"4081b83b7434af1baf51baeeaaf1545216e9b463a2",null),(0,a.registerServerReference)(o,"4027a9edcf961ae7b0f5af4b119d41462f5443359c",null),(0,a.registerServerReference)(c,"608ed05da6f063626207bbce3f2bb17e69fdfee246",null),(0,a.registerServerReference)(d,"401e67d38b57b3c4dad7b28a34e7f256632b736dfd",null),(0,a.registerServerReference)(l,"008c67a34b93be7aa0521a8693a859ec5059b72495",null),(0,a.registerServerReference)(u,"00026e1710be57f038693261f67e8e67c5c0b599f8",null),(0,a.registerServerReference)(f,"00f512c64707a4985c37eb46128af65ae3dc4ac475",null),(0,a.registerServerReference)(m,"4076e8c2e387c7d83696aa442105ed9ea5c57c98af",null),(0,a.registerServerReference)(p,"60e4ed39f891cb06e81452a85b435d3c54a93e2073",null),(0,a.registerServerReference)(_,"7085d384e28081877c94ab341cb2e8f016ec35f45c",null),(0,a.registerServerReference)(v,"401617c11f3aca3b7f9934369753b1ce4d78c5f38b",null),(0,a.registerServerReference)(b,"60c46d9d9c884a3b4a65ebcc5a05e6958fed35d7f2",null),(0,a.registerServerReference)(g,"60ae6ae0e8deba2b7fa7d4c1b4430c5a3dfc7e11fb",null),(0,a.registerServerReference)(w,"405509919c95f69114ebfb766c00fc695ee77859f5",null),(0,a.registerServerReference)(h,"00a2bbec07e1f0018a16836a6f409fbd26d68d9481",null),(0,a.registerServerReference)(y,"000bff369587377a3d73106c7a3ebf037e7bb77407",null),(0,a.registerServerReference)(S,"0049fa431e9e9bc33c34dbce28cd1da51b2e19f87c",null),(0,a.registerServerReference)(q,"009dca060ae44a63532f34ca8f39623413b9cdef26",null),(0,a.registerServerReference)(R,"40424572f1d0da9b7a6de176f7add38d4a626c413b",null),(0,a.registerServerReference)(E,"0062f1904ce4b63cebc24b499df92dcd31af7560dd",null),(0,a.registerServerReference)(j,"784d8ae0557d3fd8933ef73f2083cb27299b8d68fb",null),(0,a.registerServerReference)(x,"40add1c4dcaaf328cc92c93e1ceb800b9a1fdd544b",null),(0,a.registerServerReference)(O,"405bd7f003b295234b9b6dae24c76d4f29272046a1",null),e.s(["getDemandas",()=>s,"getNotificacoesPrazos",()=>E])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__22d884b7._.js.map