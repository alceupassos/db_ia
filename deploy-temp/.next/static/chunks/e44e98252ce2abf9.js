(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79888,e=>{"use strict";let a=(0,e.i(20587).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>a],79888)},21303,16780,e=>{"use strict";let a=(0,e.i(20587).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],21303);var t=e.i(15696),s=e.i(40977),r=e.i(433),l=e.i(71732),i=e.i(1860),n=e.i(80477);let o=l.Root,d=l.Trigger,c=l.Portal;l.Close;let m=r.forwardRef((e,a)=>{let r,i,o,d,c=(0,s.c)(9);return c[0]!==e?({className:r,...i}=e,c[0]=e,c[1]=r,c[2]=i):(r=c[1],i=c[2]),c[3]!==r?(o=(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),c[3]=r,c[4]=o):o=c[4],c[5]!==i||c[6]!==a||c[7]!==o?(d=(0,t.jsx)(l.Overlay,{ref:a,className:o,...i}),c[5]=i,c[6]=a,c[7]=o,c[8]=d):d=c[8],d});m.displayName=l.Overlay.displayName;let u=r.forwardRef((e,a)=>{let r,o,d,u,x,p,h,f=(0,s.c)(13);return f[0]!==e?({className:o,children:r,...d}=e,f[0]=e,f[1]=r,f[2]=o,f[3]=d):(r=f[1],o=f[2],d=f[3]),f[4]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)(m,{}),f[4]=u):u=f[4],f[5]!==o?(x=(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o),f[5]=o,f[6]=x):x=f[6],f[7]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsxs)(l.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(i.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),f[7]=p):p=f[7],f[8]!==r||f[9]!==d||f[10]!==a||f[11]!==x?(h=(0,t.jsxs)(c,{children:[u,(0,t.jsxs)(l.Content,{ref:a,className:x,...d,children:[r,p]})]}),f[8]=r,f[9]=d,f[10]=a,f[11]=x,f[12]=h):h=f[12],h});u.displayName=l.Content.displayName;let x=e=>{let a,r,l,i,o=(0,s.c)(8);return o[0]!==e?({className:a,...r}=e,o[0]=e,o[1]=a,o[2]=r):(a=o[1],r=o[2]),o[3]!==a?(l=(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),o[3]=a,o[4]=l):l=o[4],o[5]!==r||o[6]!==l?(i=(0,t.jsx)("div",{className:l,...r}),o[5]=r,o[6]=l,o[7]=i):i=o[7],i};x.displayName="DialogHeader";let p=e=>{let a,r,l,i,o=(0,s.c)(8);return o[0]!==e?({className:a,...r}=e,o[0]=e,o[1]=a,o[2]=r):(a=o[1],r=o[2]),o[3]!==a?(l=(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),o[3]=a,o[4]=l):l=o[4],o[5]!==r||o[6]!==l?(i=(0,t.jsx)("div",{className:l,...r}),o[5]=r,o[6]=l,o[7]=i):i=o[7],i};p.displayName="DialogFooter";let h=r.forwardRef((e,a)=>{let r,i,o,d,c=(0,s.c)(9);return c[0]!==e?({className:r,...i}=e,c[0]=e,c[1]=r,c[2]=i):(r=c[1],i=c[2]),c[3]!==r?(o=(0,n.cn)("text-lg font-semibold leading-none tracking-tight",r),c[3]=r,c[4]=o):o=c[4],c[5]!==i||c[6]!==a||c[7]!==o?(d=(0,t.jsx)(l.Title,{ref:a,className:o,...i}),c[5]=i,c[6]=a,c[7]=o,c[8]=d):d=c[8],d});h.displayName=l.Title.displayName;let f=r.forwardRef((e,a)=>{let r,i,o,d,c=(0,s.c)(9);return c[0]!==e?({className:r,...i}=e,c[0]=e,c[1]=r,c[2]=i):(r=c[1],i=c[2]),c[3]!==r?(o=(0,n.cn)("text-sm text-muted-foreground",r),c[3]=r,c[4]=o):o=c[4],c[5]!==i||c[6]!==a||c[7]!==o?(d=(0,t.jsx)(l.Description,{ref:a,className:o,...i}),c[5]=i,c[6]=a,c[7]=o,c[8]=d):d=c[8],d});f.displayName=l.Description.displayName,e.s(["Dialog",()=>o,"DialogContent",()=>u,"DialogDescription",()=>f,"DialogFooter",()=>p,"DialogHeader",()=>x,"DialogTitle",()=>h,"DialogTrigger",()=>d],16780)},99734,e=>{"use strict";var a=e.i(71940);let t=(0,a.createServerReference)("404b748f0b1946809009224a95532ef6f14a9fe75e",a.callServer,void 0,a.findSourceMapURL,"getDemandas");e.s(["getDemandas",()=>t])},48746,e=>{"use strict";var a=e.i(15696),t=e.i(433),s=e.i(80477);let r=t.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));r.displayName="Card";let l=t.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let i=t.forwardRef(({className:e,...t},r)=>(0,a.jsx)("h3",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));i.displayName="CardTitle";let n=t.forwardRef(({className:e,...t},r)=>(0,a.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...t}));n.displayName="CardDescription";let o=t.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...t}));o.displayName="CardContent",t.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>o,"CardDescription",()=>n,"CardHeader",()=>l,"CardTitle",()=>i])},71940,(e,a,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={callServer:function(){return l.callServer},createServerReference:function(){return n.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var r in s)Object.defineProperty(t,r,{enumerable:!0,get:s[r]});let l=e.r(9694),i=e.r(75127),n=e.r(5951)},84627,e=>{"use strict";let a=(0,e.i(20587).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>a],84627)},5268,e=>{"use strict";let a=(0,e.i(20587).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>a],5268)},70451,80564,89765,86913,21720,e=>{"use strict";var a=e.i(71940);let t=(0,a.createServerReference)("4076e8c2e387c7d83696aa442105ed9ea5c57c98af",a.callServer,void 0,a.findSourceMapURL,"getArquivosByDemanda");e.s(["getArquivosByDemanda",()=>t],70451);let s=(0,a.createServerReference)("60ae6ae0e8deba2b7fa7d4c1b4430c5a3dfc7e11fb",a.callServer,void 0,a.findSourceMapURL,"uploadArquivo");e.s(["uploadArquivo",()=>s],80564);let r=(0,a.createServerReference)("405509919c95f69114ebfb766c00fc695ee77859f5",a.callServer,void 0,a.findSourceMapURL,"deleteArquivoComStorage");e.s(["deleteArquivoComStorage",()=>r],89765);var l=e.i(15696),i=e.i(40977),n=e.i(433);let o=(0,e.i(20587).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>o],86913);var d=e.i(1860),c=e.i(77952);e.i(30418);var m=e.i(80477);function u(e){let a,t,s,r,u,x,p,h,f,g,j=(0,i.c)(33),{onUpload:v,disabled:N,accept:y,maxSize:w}=e,b=void 0===y?".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt":y,S=void 0===w?10:w,[_,C]=(0,n.useState)(!1),[k,D]=(0,n.useState)(!1),[q,T]=(0,n.useState)(!1),[A,R]=(0,n.useState)(null);j[0]!==S||j[1]!==v?(a=async e=>{if(e.size>1024*S*1024)return void R(`Arquivo muito grande. M\xe1ximo: ${S}MB`);D(!0),R(null);try{await v(e),D(!1),T(!0),setTimeout(()=>{T(!1)},3e3)}catch(e){R(e instanceof Error?e.message:"Erro ao fazer upload"),D(!1),T(!1)}},j[0]=S,j[1]=v,j[2]=a):a=j[2];let M=a;j[3]!==N?(t=e=>{e.preventDefault(),e.stopPropagation(),N||C(!0)},j[3]=N,j[4]=t):t=j[4];let z=t;j[5]===Symbol.for("react.memo_cache_sentinel")?(s=e=>{e.preventDefault(),e.stopPropagation(),C(!1)},j[5]=s):s=j[5];let L=s;j[6]!==N||j[7]!==M?(r=async e=>{if(e.preventDefault(),e.stopPropagation(),C(!1),R(null),N)return;let a=Array.from(e.dataTransfer.files);if(0===a.length)return;let t=a[0];await M(t)},j[6]=N,j[7]=M,j[8]=r):r=j[8];let B=r;j[9]!==M?(u=async e=>{R(null);let a=e.target.files;if(!a||0===a.length)return;let t=a[0];await M(t),e.target.value=""},j[9]=M,j[10]=u):u=j[10];let I=u,P=_?"border-primary bg-primary/5":"border-border hover:border-primary/50",E=N&&"opacity-50 cursor-not-allowed",F=(k||q)&&"pointer-events-none";return j[11]!==F||j[12]!==P||j[13]!==E?(x=(0,m.cn)("relative border-2 border-dashed rounded-lg p-8 transition-all duration-200 text-center",P,E,F),j[11]=F,j[12]=P,j[13]=E,j[14]=x):x=j[14],j[15]!==b||j[16]!==q||j[17]!==N||j[18]!==I||j[19]!==_||j[20]!==S||j[21]!==k?(p=k?(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,l.jsx)(c.Loader2,{className:"h-10 w-10 animate-spin text-primary"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enviando arquivo..."})]}):q?(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,l.jsx)(c.Loader2,{className:"h-10 w-10 animate-spin text-primary"}),(0,l.jsx)("p",{className:"text-sm font-medium text-primary",children:"Analisando documento com IA..."}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Categorizando e gerando descrição"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o,{className:(0,m.cn)("h-10 w-10 mx-auto mb-4",_?"text-primary":"text-muted-foreground")}),(0,l.jsx)("p",{className:"text-sm font-medium mb-1",children:_?"Solte o arquivo aqui":"Arraste e solte um arquivo aqui"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-4",children:"ou clique para selecionar"}),(0,l.jsx)("input",{type:"file",accept:b,onChange:I,disabled:N||k,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["PDF, DOCX, JPG, PNG (máx. ",S,"MB)"]})]}),j[15]=b,j[16]=q,j[17]=N,j[18]=I,j[19]=_,j[20]=S,j[21]=k,j[22]=p):p=j[22],j[23]!==z||j[24]!==B||j[25]!==x||j[26]!==p?(h=(0,l.jsx)("div",{onDragOver:z,onDragLeave:L,onDrop:B,className:x,children:p}),j[23]=z,j[24]=B,j[25]=x,j[26]=p,j[27]=h):h=j[27],j[28]!==A?(f=A&&(0,l.jsxs)("div",{className:"mt-2 p-3 bg-destructive/10 text-destructive border border-destructive/20 rounded-lg text-sm flex items-center gap-2",children:[(0,l.jsx)(d.X,{className:"h-4 w-4"}),A]}),j[28]=A,j[29]=f):f=j[29],j[30]!==h||j[31]!==f?(g=(0,l.jsxs)("div",{className:"w-full",children:[h,f]}),j[30]=h,j[31]=f,j[32]=g):g=j[32],g}e.s(["FileUpload",()=>u],21720)},93271,e=>{"use strict";var a=e.i(15696),t=e.i(433),s=e.i(99734),r=e.i(70451),l=e.i(80564),i=e.i(89765),n=e.i(48746),o=e.i(30418),d=e.i(98744),c=e.i(63237),m=e.i(83970),u=e.i(86913),x=e.i(54792),p=e.i(77952),h=e.i(21303),f=e.i(79888),g=e.i(20587);let j=(0,g.default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);var v=e.i(82213);let N=(0,g.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),y=(0,g.default)("file",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]]);var w=e.i(5268);let b=(0,g.default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),S=(0,g.default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var _=e.i(42915),C=e.i(21720),k=e.i(40977),D=e.i(55002);function q(e){let s,r,l,i,n,d,c,u,x,h,f,g,j,v,b,S,_=(0,k.c)(41),{arquivo:C}=e,[q,T]=(0,t.useState)(!0),[A,R]=(0,t.useState)(!1);_[0]!==C.mime_type?(s=C.mime_type?.includes("pdf"),_[0]=C.mime_type,_[1]=s):s=_[1];let M=s;_[2]!==C.mime_type?(r=C.mime_type?.includes("image"),_[2]=C.mime_type,_[3]=r):r=_[3];let z=r;_[4]!==C.mime_type?(l=C.mime_type?.includes("word")||C.mime_type?.includes("document"),_[4]=C.mime_type,_[5]=l):l=_[5];let L=l;_[6]===Symbol.for("react.memo_cache_sentinel")?(i=()=>{T(!1)},_[6]=i):i=_[6];let B=i;_[7]===Symbol.for("react.memo_cache_sentinel")?(n=()=>{T(!1),R(!0)},_[7]=n):n=_[7];let I=n;_[8]!==A||_[9]!==q?(d=q&&!A&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 z-10",children:(0,a.jsx)(p.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}),_[8]=A,_[9]=q,_[10]=d):d=_[10],_[11]!==C.nome||_[12]!==C.url||_[13]!==A||_[14]!==L||_[15]!==z||_[16]!==M?(c=C.url&&!A?(0,a.jsx)(a.Fragment,{children:z?(0,a.jsx)("img",{src:C.url,alt:C.nome,className:"w-full h-auto max-h-[500px] object-contain",onLoad:B,onError:I}):M?(0,a.jsx)("iframe",{src:C.url,className:"w-full h-[500px]",onLoad:B,onError:I}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[400px]",children:[L&&(0,a.jsx)(y,{className:"h-16 w-16 text-blue-500 mb-4"}),!L&&(0,a.jsx)(y,{className:"h-16 w-16 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Preview não disponível para este tipo de arquivo"}),(0,a.jsxs)(o.Button,{variant:"outline",className:"mt-4",onClick:()=>window.open(C.url,"_blank"),children:[(0,a.jsx)(w.Download,{className:"h-4 w-4 mr-2"}),"Baixar Arquivo"]})]})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[400px]",children:[M&&(0,a.jsx)(m.FileText,{className:"h-16 w-16 text-red-400 mb-4"}),z&&(0,a.jsx)(N,{className:"h-16 w-16 text-blue-400 mb-4"}),L&&(0,a.jsx)(y,{className:"h-16 w-16 text-blue-500 mb-4"}),!M&&!z&&!L&&(0,a.jsx)(y,{className:"h-16 w-16 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:A?"Erro ao carregar arquivo":"Preview não disponível"})]}),_[11]=C.nome,_[12]=C.url,_[13]=A,_[14]=L,_[15]=z,_[16]=M,_[17]=c):c=_[17],_[18]!==d||_[19]!==c?(u=(0,a.jsxs)("div",{className:"relative min-h-[400px] border rounded-lg overflow-hidden bg-muted",children:[d,c]}),_[18]=d,_[19]=c,_[20]=u):u=_[20],_[21]!==C.nome?(x=(0,a.jsx)("p",{className:"text-sm font-medium",children:C.nome}),_[21]=C.nome,_[22]=x):x=_[22];let P=C.mime_type||"Tipo desconhecido";return _[23]!==P?(h=(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:P}),_[23]=P,_[24]=h):h=_[24],_[25]!==h||_[26]!==x?(f=(0,a.jsxs)("div",{children:[x,h]}),_[25]=h,_[26]=x,_[27]=f):f=_[27],_[28]!==C.url?(g=C.url&&(0,a.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>window.open(C.url,"_blank"),children:[(0,a.jsx)(w.Download,{className:"h-4 w-4 mr-2"}),"Baixar"]}),_[28]=C.url,_[29]=g):g=_[29],_[30]!==g?(j=(0,a.jsx)("div",{className:"flex items-center gap-2",children:g}),_[30]=g,_[31]=j):j=_[31],_[32]!==f||_[33]!==j?(v=(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[f,j]}),_[32]=f,_[33]=j,_[34]=v):v=_[34],_[35]!==C.resumo_ia?(b=C.resumo_ia&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:"Resumo da IA"}),(0,a.jsx)(D.ScrollArea,{className:"h-[150px]",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:C.resumo_ia})})]}),_[35]=C.resumo_ia,_[36]=b):b=_[36],_[37]!==v||_[38]!==b||_[39]!==u?(S=(0,a.jsxs)("div",{className:"space-y-4",children:[u,v,b]}),_[37]=v,_[38]=b,_[39]=u,_[40]=S):S=_[40],S}var T=e.i(89642),A=e.i(15133),R=e.i(80477);function M({arquivo:e}){let[s,r]=(0,t.useState)([]),[l,i]=(0,t.useState)(""),[n,c]=(0,t.useState)(!1),u=(0,t.useRef)(null);(0,t.useEffect)(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)},[s]);let x=async a=>{if(a.preventDefault(),!l.trim()||n)return;let t={id:Date.now().toString(),role:"user",content:l};r(e=>[...e,t]),i(""),c(!0);try{let a=await fetch("/api/juridico/file-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:l,arquivoId:e.id,arquivoNome:e.nome,resumoIA:e.resumo_ia,storageUrl:e.storage_url})});if(!a.ok)throw Error("Erro ao processar pergunta");let t=await a.json(),s={id:(Date.now()+1).toString(),role:"assistant",content:t.response};r(e=>[...e,s])}catch(a){console.error("Erro:",a);let e={id:(Date.now()+1).toString(),role:"assistant",content:"Desculpe, ocorreu um erro ao processar sua pergunta. Tente novamente."};r(a=>[...a,e])}finally{c(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col h-[500px]",children:[(0,a.jsxs)("div",{className:"p-3 border-b space-y-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Perguntas rápidas"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:["Resuma este documento","Quais são os pontos principais?","Identifique riscos ou problemas","Quais são as datas importantes?"].map(e=>(0,a.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>i(e),disabled:n,className:"text-xs",children:e},e))})]}),(0,a.jsx)(D.ScrollArea,{className:"flex-1 p-4",ref:u,children:(0,a.jsxs)("div",{className:"space-y-4",children:[0===s.length&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,a.jsx)(m.FileText,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:["Faça perguntas sobre o arquivo: ",(0,a.jsx)("strong",{children:e.nome})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"A IA pode resumir, analisar e responder dúvidas sobre o conteúdo."})]}),s.map(e=>(0,a.jsxs)("div",{className:(0,R.cn)("flex gap-3","user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&(0,a.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary shrink-0",children:(0,a.jsx)(A.Sparkles,{className:"h-4 w-4 text-primary-foreground"})}),(0,a.jsx)("div",{className:(0,R.cn)("rounded-lg px-4 py-2 max-w-[80%]","user"===e.role?"bg-primary text-primary-foreground":"bg-muted text-foreground"),children:(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})})]},e.id)),n&&(0,a.jsxs)("div",{className:"flex gap-3 justify-start",children:[(0,a.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary shrink-0",children:(0,a.jsx)(A.Sparkles,{className:"h-4 w-4 text-primary-foreground"})}),(0,a.jsx)("div",{className:"rounded-lg px-4 py-2 bg-muted",children:(0,a.jsx)(p.Loader2,{className:"h-4 w-4 animate-spin"})})]})]})}),(0,a.jsx)("form",{onSubmit:x,className:"border-t p-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.Input,{value:l,onChange:e=>i(e.target.value),placeholder:"Pergunte sobre o arquivo...",disabled:n,className:"flex-1"}),(0,a.jsx)(o.Button,{type:"submit",disabled:n||!l.trim(),children:n?(0,a.jsx)(p.Loader2,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(T.Send,{className:"h-4 w-4"})})]})})]})}var z=e.i(99209),L=e.i(16780);function B(){let[e,g]=(0,t.useState)([]),[k,D]=(0,t.useState)([]),[T,A]=(0,t.useState)(!0),[R,B]=(0,t.useState)(""),[I,P]=(0,t.useState)("all"),[E,F]=(0,t.useState)("all"),[U,V]=(0,t.useState)("all"),[O,H]=(0,t.useState)(null),[G,X]=(0,t.useState)(!1),[J,K]=(0,t.useState)(!1),[Q,$]=(0,t.useState)(""),W=(0,t.useCallback)(async()=>{A(!0);try{let e=await (0,s.getDemandas)();D(e);let a=[];for(let t of e)(await (0,r.getArquivosByDemanda)(t.id)).forEach(e=>{a.push({id:String(e.id||""),nome:String(e.nome||""),tipo:e.tipo?String(e.tipo):null,supabase_path:e.supabase_path?String(e.supabase_path):null,storage_url:e.storage_url?String(e.storage_url):null,mime_type:e.mime_type?String(e.mime_type):null,resumo_ia:e.resumo_ia?String(e.resumo_ia):null,categoria:e.categoria?String(e.categoria):null,descricao_ia:e.descricao_ia?String(e.descricao_ia):null,demanda_id:t.id,demanda_nome:t.demanda,created_at:String(e.created_at||"")})});g(a)}catch(e){console.error("Erro ao carregar dados:",e)}finally{A(!1)}},[]);(0,t.useEffect)(()=>{W()},[W]);let Y=async e=>{if(!Q)throw Error("Selecione uma demanda para vincular o arquivo");let a=new FormData;a.append("file",e),await (0,l.uploadArquivo)(Q,a),W()},Z=async e=>{if(confirm("Tem certeza que deseja excluir este arquivo?"))try{await (0,i.deleteArquivoComStorage)(e),W()}catch(e){console.error("Erro ao excluir arquivo:",e),alert("Erro ao excluir arquivo")}},ee=Array.from(new Set(e.map(e=>e.categoria).filter(e=>"string"==typeof e&&e.length>0))).sort(),ea=e.filter(e=>{let a=e.nome.toLowerCase().includes(R.toLowerCase())||e.demanda_nome?.toLowerCase().includes(R.toLowerCase())||e.descricao_ia?.toLowerCase().includes(R.toLowerCase()),t="all"===I||e.demanda_id===I,s="all"===E||"pdf"===E&&e.mime_type?.includes("pdf")||"image"===E&&e.mime_type?.includes("image")||"doc"===E&&(e.mime_type?.includes("word")||e.mime_type?.includes("document")),r="all"===U||e.categoria===U;return a&&t&&s&&r});return(0,a.jsxs)("div",{className:"flex-1 space-y-6 p-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Arquivos"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Gerencie contratos, documentos e arquivos das demandas"})]})}),(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Upload,{className:"h-5 w-5"}),"Adicionar Arquivo"]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)(z.Select,{value:Q,onValueChange:$,children:[(0,a.jsx)(z.SelectTrigger,{children:(0,a.jsx)(z.SelectValue,{placeholder:"Selecione a demanda para vincular o arquivo"})}),(0,a.jsx)(z.SelectContent,{children:k.map(e=>(0,a.jsxs)(z.SelectItem,{value:e.id,children:[e.demanda," - ",e.cliente_nome]},e.id))})]})}),(0,a.jsx)(C.FileUpload,{onUpload:Y,disabled:!Q,maxSize:10})]})]}),(0,a.jsx)(n.Card,{children:(0,a.jsx)(n.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(x.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(d.Input,{placeholder:"Buscar arquivos...",value:R,onChange:e=>B(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(z.Select,{value:I,onValueChange:P,children:[(0,a.jsx)(z.SelectTrigger,{className:"w-full md:w-[200px]",children:(0,a.jsx)(z.SelectValue,{placeholder:"Filtrar por demanda"})}),(0,a.jsxs)(z.SelectContent,{children:[(0,a.jsx)(z.SelectItem,{value:"all",children:"Todas as demandas"}),k.map(e=>(0,a.jsxs)(z.SelectItem,{value:e.id,children:[e.demanda.substring(0,30),"..."]},e.id))]})]}),(0,a.jsxs)(z.Select,{value:E,onValueChange:F,children:[(0,a.jsx)(z.SelectTrigger,{className:"w-full md:w-[150px]",children:(0,a.jsx)(z.SelectValue,{placeholder:"Tipo"})}),(0,a.jsxs)(z.SelectContent,{children:[(0,a.jsx)(z.SelectItem,{value:"all",children:"Todos os tipos"}),(0,a.jsx)(z.SelectItem,{value:"pdf",children:"PDF"}),(0,a.jsx)(z.SelectItem,{value:"image",children:"Imagens"}),(0,a.jsx)(z.SelectItem,{value:"doc",children:"Documentos"})]})]}),(0,a.jsxs)(z.Select,{value:U,onValueChange:V,children:[(0,a.jsx)(z.SelectTrigger,{className:"w-full md:w-[150px]",children:(0,a.jsx)(z.SelectValue,{placeholder:"Categoria"})}),(0,a.jsxs)(z.SelectContent,{children:[(0,a.jsx)(z.SelectItem,{value:"all",children:"Todas as categorias"}),ee.map(e=>(0,a.jsx)(z.SelectItem,{value:e,children:e},e))]})]})]})})}),T?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(p.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):0===ea.length?(0,a.jsx)(n.Card,{children:(0,a.jsxs)(n.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)(v.FolderOpen,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Nenhum arquivo encontrado"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Selecione uma demanda e arraste um arquivo para fazer upload"})]})}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:ea.map(e=>{var t;return(0,a.jsx)(n.Card,{className:"hover:border-primary/50 transition-colors",children:(0,a.jsxs)(n.CardContent,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,a.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted flex-shrink-0",children:(t=e.mime_type)?t.includes("pdf")?(0,a.jsx)(m.FileText,{className:"h-5 w-5 text-red-400"}):t.includes("image")?(0,a.jsx)(N,{className:"h-5 w-5 text-blue-400"}):t.includes("word")||t.includes("document")?(0,a.jsx)(y,{className:"h-5 w-5 text-blue-500"}):(0,a.jsx)(y,{className:"h-5 w-5"}):(0,a.jsx)(y,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsx)("h3",{className:"font-medium truncate flex-1",title:e.nome,children:e.nome}),e.descricao_ia&&(0,a.jsxs)(c.Badge,{variant:"default",className:"text-xs flex items-center gap-1 flex-shrink-0",children:[(0,a.jsx)(S,{className:"h-3 w-3"}),"Incluído"]})]}),e.demanda_nome&&(0,a.jsxs)(_.default,{href:`/juridico/${e.demanda_id}`,className:"text-xs text-primary hover:underline font-medium mt-1 flex items-center gap-1 group",children:[(0,a.jsx)(b,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"truncate",children:e.demanda_nome})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 mb-3",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 flex-shrink-0",children:[e.categoria&&(0,a.jsx)(c.Badge,{variant:"default",className:"text-xs w-fit",children:e.categoria}),e.tipo&&(0,a.jsx)(c.Badge,{variant:"outline",className:"text-xs w-fit",children:e.tipo})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:e.descricao_ia?(0,a.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-3",title:e.descricao_ia,children:e.descricao_ia}):e.resumo_ia?(0,a.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-3",children:e.resumo_ia}):(0,a.jsx)("p",{className:"text-xs text-muted-foreground italic",children:"Aguardando análise..."})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 pt-3 border-t",children:[(0,a.jsxs)(o.Button,{variant:"ghost",size:"sm",onClick:()=>{H(e),X(!0)},children:[(0,a.jsx)(f.Eye,{className:"h-4 w-4 mr-1"}),"Ver"]}),(0,a.jsxs)(o.Button,{variant:"ghost",size:"sm",onClick:()=>{H(e),K(!0)},children:[(0,a.jsx)(j,{className:"h-4 w-4 mr-1"}),"Perguntar"]}),e.storage_url&&(0,a.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>window.open(e.storage_url,"_blank"),children:(0,a.jsx)(w.Download,{className:"h-4 w-4"})}),(0,a.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>Z(e.id),className:"text-destructive hover:text-destructive",children:(0,a.jsx)(h.Trash2,{className:"h-4 w-4"})})]})]})},e.id)})}),(0,a.jsx)(L.Dialog,{open:G,onOpenChange:X,children:(0,a.jsxs)(L.DialogContent,{className:"max-w-4xl max-h-[90vh]",children:[(0,a.jsx)(L.DialogHeader,{children:(0,a.jsx)(L.DialogTitle,{children:O?.nome})}),O&&(0,a.jsx)(q,{arquivo:{...O,url:O.storage_url||void 0}})]})}),(0,a.jsx)(L.Dialog,{open:J,onOpenChange:K,children:(0,a.jsxs)(L.DialogContent,{className:"max-w-2xl max-h-[90vh]",children:[(0,a.jsx)(L.DialogHeader,{children:(0,a.jsxs)(L.DialogTitle,{children:["Perguntar sobre: ",O?.nome]})}),O&&(0,a.jsx)(M,{arquivo:O})]})})]})}e.s(["default",()=>B],93271)}]);