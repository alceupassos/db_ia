(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,48746,e=>{"use strict";var a=e.i(15696),t=e.i(433),r=e.i(80477);let s=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));s.displayName="Card";let n=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...t}));n.displayName="CardHeader";let i=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("h3",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));i.displayName="CardTitle";let l=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("p",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let o=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",e),...t}));o.displayName="CardContent",t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>o,"CardDescription",()=>l,"CardHeader",()=>n,"CardTitle",()=>i])},71940,(e,a,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={callServer:function(){return n.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var s in r)Object.defineProperty(t,s,{enumerable:!0,get:r[s]});let n=e.r(9694),i=e.r(75127),l=e.r(5951)},84627,e=>{"use strict";let a=(0,e.i(20587).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>a],84627)},87132,41420,e=>{"use strict";var a=e.i(20587);let t=(0,a.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],87132);let r=(0,a.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>r],41420)},5268,e=>{"use strict";let a=(0,e.i(20587).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>a],5268)},70451,80564,89765,86913,21720,e=>{"use strict";var a=e.i(71940);let t=(0,a.createServerReference)("4076e8c2e387c7d83696aa442105ed9ea5c57c98af",a.callServer,void 0,a.findSourceMapURL,"getArquivosByDemanda");e.s(["getArquivosByDemanda",()=>t],70451);let r=(0,a.createServerReference)("60ae6ae0e8deba2b7fa7d4c1b4430c5a3dfc7e11fb",a.callServer,void 0,a.findSourceMapURL,"uploadArquivo");e.s(["uploadArquivo",()=>r],80564);let s=(0,a.createServerReference)("405509919c95f69114ebfb766c00fc695ee77859f5",a.callServer,void 0,a.findSourceMapURL,"deleteArquivoComStorage");e.s(["deleteArquivoComStorage",()=>s],89765);var n=e.i(15696);e.i(40977);var i=e.i(433);let l=(0,e.i(20587).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>l],86913);var o=e.i(1860),c=e.i(77952);e.i(30418);var d=e.i(80477);function u({onUpload:e,disabled:a,accept:t=".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt",maxSize:r=10}){let[s,u]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1),[p,x]=(0,i.useState)(null),h=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a||u(!0)},[a]),v=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),u(!1)},[]),g=(0,i.useCallback)(async e=>{if(e.preventDefault(),e.stopPropagation(),u(!1),x(null),a)return;let t=Array.from(e.dataTransfer.files);if(0===t.length)return;let r=t[0];await y(r)},[a,r,e]),j=(0,i.useCallback)(async e=>{x(null);let a=e.target.files;if(!a||0===a.length)return;let t=a[0];await y(t),e.target.value=""},[r,e]),y=async a=>{if(a.size>1024*r*1024)return void x(`Arquivo muito grande. M\xe1ximo: ${r}MB`);f(!0);try{await e(a)}catch(e){x(e instanceof Error?e.message:"Erro ao fazer upload")}finally{f(!1)}};return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("div",{onDragOver:h,onDragLeave:v,onDrop:g,className:(0,d.cn)("relative border-2 border-dashed rounded-lg p-8 transition-all duration-200 text-center",s?"border-primary bg-primary/5":"border-border hover:border-primary/50",a&&"opacity-50 cursor-not-allowed",m&&"pointer-events-none"),children:m?(0,n.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,n.jsx)(c.Loader2,{className:"h-10 w-10 animate-spin text-primary"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enviando arquivo..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{className:(0,d.cn)("h-10 w-10 mx-auto mb-4",s?"text-primary":"text-muted-foreground")}),(0,n.jsx)("p",{className:"text-sm font-medium mb-1",children:s?"Solte o arquivo aqui":"Arraste e solte um arquivo aqui"}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground mb-4",children:"ou clique para selecionar"}),(0,n.jsx)("input",{type:"file",accept:t,onChange:j,disabled:a||m,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),(0,n.jsxs)("p",{className:"text-xs text-muted-foreground",children:["PDF, DOCX, JPG, PNG (máx. ",r,"MB)"]})]})}),p&&(0,n.jsxs)("div",{className:"mt-2 p-3 bg-destructive/10 text-destructive border border-destructive/20 rounded-lg text-sm flex items-center gap-2",children:[(0,n.jsx)(o.X,{className:"h-4 w-4"}),p]})]})}e.s(["FileUpload",()=>u],21720)},21303,16780,e=>{"use strict";let a=(0,e.i(20587).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],21303);var t=e.i(15696),r=e.i(40977),s=e.i(433),n=e.i(71732),i=e.i(1860),l=e.i(80477);let o=n.Root,c=n.Trigger,d=n.Portal;n.Close;let u=s.forwardRef((e,a)=>{let s,i,o,c,d=(0,r.c)(9);return d[0]!==e?({className:s,...i}=e,d[0]=e,d[1]=s,d[2]=i):(s=d[1],i=d[2]),d[3]!==s?(o=(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),d[3]=s,d[4]=o):o=d[4],d[5]!==i||d[6]!==a||d[7]!==o?(c=(0,t.jsx)(n.Overlay,{ref:a,className:o,...i}),d[5]=i,d[6]=a,d[7]=o,d[8]=c):c=d[8],c});u.displayName=n.Overlay.displayName;let m=s.forwardRef((e,a)=>{let s,o,c,m,f,p,x,h=(0,r.c)(13);return h[0]!==e?({className:o,children:s,...c}=e,h[0]=e,h[1]=s,h[2]=o,h[3]=c):(s=h[1],o=h[2],c=h[3]),h[4]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(u,{}),h[4]=m):m=h[4],h[5]!==o?(f=(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o),h[5]=o,h[6]=f):f=h[6],h[7]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsxs)(n.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(i.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),h[7]=p):p=h[7],h[8]!==s||h[9]!==c||h[10]!==a||h[11]!==f?(x=(0,t.jsxs)(d,{children:[m,(0,t.jsxs)(n.Content,{ref:a,className:f,...c,children:[s,p]})]}),h[8]=s,h[9]=c,h[10]=a,h[11]=f,h[12]=x):x=h[12],x});m.displayName=n.Content.displayName;let f=e=>{let a,s,n,i,o=(0,r.c)(8);return o[0]!==e?({className:a,...s}=e,o[0]=e,o[1]=a,o[2]=s):(a=o[1],s=o[2]),o[3]!==a?(n=(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),o[3]=a,o[4]=n):n=o[4],o[5]!==s||o[6]!==n?(i=(0,t.jsx)("div",{className:n,...s}),o[5]=s,o[6]=n,o[7]=i):i=o[7],i};f.displayName="DialogHeader";let p=e=>{let a,s,n,i,o=(0,r.c)(8);return o[0]!==e?({className:a,...s}=e,o[0]=e,o[1]=a,o[2]=s):(a=o[1],s=o[2]),o[3]!==a?(n=(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),o[3]=a,o[4]=n):n=o[4],o[5]!==s||o[6]!==n?(i=(0,t.jsx)("div",{className:n,...s}),o[5]=s,o[6]=n,o[7]=i):i=o[7],i};p.displayName="DialogFooter";let x=s.forwardRef((e,a)=>{let s,i,o,c,d=(0,r.c)(9);return d[0]!==e?({className:s,...i}=e,d[0]=e,d[1]=s,d[2]=i):(s=d[1],i=d[2]),d[3]!==s?(o=(0,l.cn)("text-lg font-semibold leading-none tracking-tight",s),d[3]=s,d[4]=o):o=d[4],d[5]!==i||d[6]!==a||d[7]!==o?(c=(0,t.jsx)(n.Title,{ref:a,className:o,...i}),d[5]=i,d[6]=a,d[7]=o,d[8]=c):c=d[8],c});x.displayName=n.Title.displayName;let h=s.forwardRef((e,a)=>{let s,i,o,c,d=(0,r.c)(9);return d[0]!==e?({className:s,...i}=e,d[0]=e,d[1]=s,d[2]=i):(s=d[1],i=d[2]),d[3]!==s?(o=(0,l.cn)("text-sm text-muted-foreground",s),d[3]=s,d[4]=o):o=d[4],d[5]!==i||d[6]!==a||d[7]!==o?(c=(0,t.jsx)(n.Description,{ref:a,className:o,...i}),d[5]=i,d[6]=a,d[7]=o,d[8]=c):c=d[8],c});h.displayName=n.Description.displayName,e.s(["Dialog",()=>o,"DialogContent",()=>m,"DialogDescription",()=>h,"DialogFooter",()=>p,"DialogHeader",()=>f,"DialogTitle",()=>x,"DialogTrigger",()=>c],16780)},90739,30836,e=>{"use strict";var a=e.i(71940);let t=(0,a.createServerReference)("401e67d38b57b3c4dad7b28a34e7f256632b736dfd",a.callServer,void 0,a.findSourceMapURL,"deleteDemanda");e.s(["deleteDemanda",()=>t],90739);let r=(0,e.i(20587).default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>r],30836)},77472,e=>{"use strict";var a=e.i(15696),t=e.i(433),r=e.i(71940);let s=(0,r.createServerReference)("4081b83b7434af1baf51baeeaaf1545216e9b463a2",r.callServer,void 0,r.findSourceMapURL,"getDemandaById"),n=(0,r.createServerReference)("608ed05da6f063626207bbce3f2bb17e69fdfee246",r.callServer,void 0,r.findSourceMapURL,"updateDemanda");var i=e.i(70451),l=e.i(80564),o=e.i(90739);let c=(0,r.createServerReference)("7085d384e28081877c94ab341cb2e8f016ec35f45c",r.callServer,void 0,r.findSourceMapURL,"updateDemandaField"),d=(0,r.createServerReference)("60c46d9d9c884a3b4a65ebcc5a05e6958fed35d7f2",r.callServer,void 0,r.findSourceMapURL,"updateArquivo");var u=e.i(89765),m=e.i(21720),f=e.i(15133),p=e.i(77952),x=e.i(83970),h=e.i(30418),v=e.i(48746);e.i(30619);var g=e.i(43044),j=e.i(19667),y=e.i(32469),N=e.i(27904),b=e.i(94472),w=t,C=e.i(7476);function S(e,a){if("function"==typeof e)return e(a);null!=e&&(e.current=a)}class k extends w.Component{getSnapshotBeforeUpdate(e){let a=this.props.childRef.current;if(a&&e.isPresent&&!this.props.isPresent){let e=a.offsetParent,t=(0,b.isHTMLElement)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=a.offsetHeight||0,r.width=a.offsetWidth||0,r.top=a.offsetTop,r.left=a.offsetLeft,r.right=t-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function D({children:e,isPresent:r,anchorX:s,root:n}){let i=(0,w.useId)(),l=(0,w.useRef)(null),o=(0,w.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=(0,w.useContext)(C.MotionConfigContext),d=function(...e){return t.useCallback(function(...e){return a=>{let t=!1,r=e.map(e=>{let r=S(e,a);return t||"function"!=typeof r||(t=!0),r});if(t)return()=>{for(let a=0;a<r.length;a++){let t=r[a];"function"==typeof t?t():S(e[a],null)}}}}(...e),e)}(l,e?.ref);return(0,w.useInsertionEffect)(()=>{let{width:e,height:a,top:t,left:d,right:u}=o.current;if(r||!l.current||!e||!a)return;let m="left"===s?`left: ${d}`:`right: ${u}`;l.current.dataset.motionPopId=i;let f=document.createElement("style");c&&(f.nonce=c);let p=n??document.head;return p.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            ${m}px !important;
            top: ${t}px !important;
          }
        `),()=>{p.contains(f)&&p.removeChild(f)}},[r]),(0,a.jsx)(k,{isPresent:r,childRef:l,sizeRef:o,children:w.cloneElement(e,{ref:d})})}let R=({children:e,initial:r,isPresent:s,onExitComplete:n,custom:i,presenceAffectsLayout:l,mode:o,anchorX:c,root:d})=>{let u=(0,j.useConstant)(E),m=(0,t.useId)(),f=!0,p=(0,t.useMemo)(()=>(f=!1,{id:m,initial:r,isPresent:s,custom:i,onExitComplete:e=>{for(let a of(u.set(e,!0),u.values()))if(!a)return;n&&n()},register:e=>(u.set(e,!1),()=>u.delete(e))}),[s,u,n]);return l&&f&&(p={...p}),(0,t.useMemo)(()=>{u.forEach((e,a)=>u.set(a,!1))},[s]),t.useEffect(()=>{s||u.size||!n||n()},[s]),"popLayout"===o&&(e=(0,a.jsx)(D,{isPresent:s,anchorX:c,root:d,children:e})),(0,a.jsx)(N.PresenceContext.Provider,{value:p,children:e})};function E(){return new Map}var M=e.i(38934);let T=e=>e.key||"";function P(e){let a=[];return t.Children.forEach(e,e=>{(0,t.isValidElement)(e)&&a.push(e)}),a}let z=({children:e,custom:r,initial:s=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:l="sync",propagate:o=!1,anchorX:c="left",root:d})=>{let[u,m]=(0,M.usePresence)(o),f=(0,t.useMemo)(()=>P(e),[e]),p=o&&!u?[]:f.map(T),x=(0,t.useRef)(!0),h=(0,t.useRef)(f),v=(0,j.useConstant)(()=>new Map),[N,b]=(0,t.useState)(f),[w,C]=(0,t.useState)(f);(0,y.useIsomorphicLayoutEffect)(()=>{x.current=!1,h.current=f;for(let e=0;e<w.length;e++){let a=T(w[e]);p.includes(a)?v.delete(a):!0!==v.get(a)&&v.set(a,!1)}},[w,p.length,p.join("-")]);let S=[];if(f!==N){let e=[...f];for(let a=0;a<w.length;a++){let t=w[a],r=T(t);p.includes(r)||(e.splice(a,0,t),S.push(t))}return"wait"===l&&S.length&&(e=S),C(P(e)),b(f),null}let{forceRender:k}=(0,t.useContext)(g.LayoutGroupContext);return(0,a.jsx)(a.Fragment,{children:w.map(e=>{let t=T(e),g=(!o||!!u)&&(f===w||p.includes(t));return(0,a.jsx)(R,{isPresent:g,initial:(!x.current||!!s)&&void 0,custom:r,presenceAffectsLayout:i,mode:l,root:d,onExitComplete:g?void 0:()=>{if(!v.has(t))return;v.set(t,!0);let e=!0;v.forEach(a=>{a||(e=!1)}),e&&(k?.(),C(h.current),o&&m?.(),n&&n())},anchorX:c,children:e},t)})})};var B=e.i(78046);function L({arquivoId:e,arquivoNome:r,storageUrl:s,onSummaryGenerated:n}){let[i,l]=(0,t.useState)(!1),[o,c]=(0,t.useState)(null),[d,u]=(0,t.useState)(null),m=async()=>{l(!0),u(null);try{let a=await fetch("/api/juridico/resumir-contrato",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({arquivoId:e,arquivoNome:r,storageUrl:s})});if(!a.ok)throw Error("Erro ao gerar resumo");let t=await a.json();c(t.resumo),n&&n(t.resumo)}catch(e){u(e instanceof Error?e.message:"Erro ao gerar resumo")}finally{l(!1)}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(h.Button,{onClick:m,disabled:i||!s,variant:"outline",className:"w-full",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Processando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Sparkles,{className:"mr-2 h-4 w-4"}),"Resumir com IA"]})}),(0,a.jsxs)(z,{children:[d&&(0,a.jsx)(B.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 bg-destructive/10 text-destructive border border-destructive/20 rounded-lg text-sm",children:d}),o&&(0,a.jsx)(B.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:(0,a.jsx)(v.Card,{children:(0,a.jsxs)(v.CardContent,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(x.FileText,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("h4",{className:"font-medium",children:"Resumo Gerado pela IA"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:o})]})})})]})]})}var q=e.i(54792),A=e.i(98744);function _({onSearch:e,demandaId:r}){let[s,n]=(0,t.useState)(""),[i,l]=(0,t.useState)(!1),o=async()=>{if(s.trim()){l(!0);try{let a=await fetch("/api/juridico/buscar-semantica",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s,demandaId:r})});if(!a.ok)throw Error("Erro na busca");let t=await a.json();e(s,t.results||[])}catch(e){console.error("Erro na busca:",e)}finally{l(!1)}}};return(0,a.jsx)(v.Card,{children:(0,a.jsx)(v.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(q.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(A.Input,{type:"text",value:s,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&o(),placeholder:"Busca semântica usando IA...",className:"pl-9"})]}),(0,a.jsx)(h.Button,{onClick:o,disabled:i||!s.trim(),variant:"outline",size:"icon",children:i?(0,a.jsx)(p.Loader2,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(f.Sparkles,{className:"h-4 w-4"})})]})})})}var U=e.i(87132),F=e.i(41420);let O=(0,e.i(20587).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var H=e.i(21303),I=e.i(5268),$=e.i(42915),V=e.i(33870),X=e.i(63237),G=e.i(30836),J=e.i(84627),K=e.i(1860),W=e.i(80477);function Q({label:e,value:r,type:s="text",onSave:n,className:i,placeholder:l}){let[o,c]=(0,t.useState)(!1),[d,u]=(0,t.useState)(r||""),[m,f]=(0,t.useState)(!1),[x,v]=(0,t.useState)(null),g=async()=>{f(!0),v(null);try{await n(d),c(!1)}catch(e){v(e instanceof Error?e.message:"Erro ao salvar")}finally{f(!1)}};return o?(0,a.jsxs)("div",{className:(0,W.cn)("space-y-2",i),children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:e}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["textarea"===s?(0,a.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),className:"flex-1 min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",placeholder:l}):(0,a.jsx)(A.Input,{type:"date"===s?"date":"text",value:"date"===s?(e=>{if(!e)return"";try{return new Date(e).toISOString().split("T")[0]}catch{return e}})(d):d,onChange:e=>u(e.target.value),className:"flex-1",placeholder:l}),(0,a.jsx)(h.Button,{size:"icon",variant:"ghost",onClick:g,disabled:m,className:"h-9 w-9",children:m?(0,a.jsx)(p.Loader2,{className:"h-4 w-4 animate-spin text-primary"}):(0,a.jsx)(J.Check,{className:"h-4 w-4 text-green-500"})}),(0,a.jsx)(h.Button,{size:"icon",variant:"ghost",onClick:()=>{u(r||""),c(!1),v(null)},disabled:m,className:"h-9 w-9",children:(0,a.jsx)(K.X,{className:"h-4 w-4 text-destructive"})})]}),x&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:x})]}):(0,a.jsxs)("div",{className:(0,W.cn)("space-y-2",i),children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:e}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"flex-1 font-medium",children:"date"===s?(e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("pt-BR")}catch{return e}})(r):r||"-"}),(0,a.jsx)(h.Button,{size:"icon",variant:"ghost",onClick:()=>{u(r||""),c(!0),v(null)},className:"h-8 w-8",children:(0,a.jsx)(G.Pencil,{className:"h-4 w-4 text-muted-foreground"})})]})]})}var Y=e.i(16780);function Z(){let e=(0,V.useParams)(),r=(0,V.useRouter)(),f=e.id,[g,j]=(0,t.useState)(!0),[y,N]=(0,t.useState)(!1),[b,w]=(0,t.useState)(!1),[C,S]=(0,t.useState)(null),[k,D]=(0,t.useState)([]),[R,E]=(0,t.useState)({}),[M,T]=(0,t.useState)(!1);async function P(){j(!0);try{let[e,a]=await Promise.all([s(f),(0,i.getArquivosByDemanda)(f)]);S(e),E(e),D(a)}catch(e){console.error("Erro ao carregar dados:",e)}finally{j(!1)}}(0,t.useEffect)(()=>{P()},[f]);let z=async()=>{N(!0);try{await n(f,R),S(R),w(!1)}catch(e){alert("Erro ao salvar: "+(e instanceof Error?e.message:"Erro desconhecido"))}finally{N(!1)}},B=async()=>{try{await (0,o.deleteDemanda)(f),r.push("/juridico")}catch(e){alert("Erro ao excluir: "+(e instanceof Error?e.message:"Erro desconhecido"))}},q=async e=>{let a=new FormData;a.append("file",e),await (0,l.uploadArquivo)(f,a),P()};return g?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)(p.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):C?(0,a.jsxs)("div",{className:"flex-1 space-y-6 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)($.default,{href:"/juridico",children:(0,a.jsx)(h.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(U.ArrowLeft,{className:"h-4 w-4"})})}),(0,a.jsx)("div",{className:"flex-1",children:b?(0,a.jsx)(A.Input,{value:R.demanda||"",onChange:e=>E({...R,demanda:e.target.value}),className:"text-2xl font-bold"}):(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:C.demanda})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(e=>{switch(e){case"CONCLUÍDO":return(0,a.jsx)(X.Badge,{variant:"success",children:"Concluído"});case"EM ANDAMENTO":return(0,a.jsx)(X.Badge,{variant:"warning",children:"Em Andamento"});case"PENDENTE":return(0,a.jsx)(X.Badge,{variant:"error",children:"Pendente"});case"Cancelado":return(0,a.jsx)(X.Badge,{variant:"outline",children:"Cancelado"});default:return(0,a.jsx)(X.Badge,{variant:"outline",children:e})}})(C.status),b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Button,{onClick:z,disabled:y,size:"sm",children:[y?(0,a.jsx)(p.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(F.Save,{className:"mr-2 h-4 w-4"}),"Salvar"]}),(0,a.jsx)(h.Button,{variant:"outline",onClick:()=>{w(!1),E(C||{})},size:"sm",children:"Cancelar"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Button,{variant:"outline",onClick:()=>w(!0),size:"sm",children:[(0,a.jsx)(O,{className:"mr-2 h-4 w-4"}),"Editar"]}),(0,a.jsxs)(Y.Dialog,{open:M,onOpenChange:T,children:[(0,a.jsx)(Y.DialogTrigger,{asChild:!0,children:(0,a.jsx)(h.Button,{variant:"destructive",size:"sm",children:(0,a.jsx)(H.Trash2,{className:"h-4 w-4"})})}),(0,a.jsxs)(Y.DialogContent,{children:[(0,a.jsxs)(Y.DialogHeader,{children:[(0,a.jsx)(Y.DialogTitle,{children:"Excluir Demanda"}),(0,a.jsx)(Y.DialogDescription,{children:"Tem certeza que deseja excluir esta demanda? Esta ação não pode ser desfeita."})]}),(0,a.jsxs)(Y.DialogFooter,{children:[(0,a.jsx)(h.Button,{variant:"outline",onClick:()=>T(!1),children:"Cancelar"}),(0,a.jsx)(h.Button,{variant:"destructive",onClick:B,children:"Excluir"})]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-3",children:[(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,a.jsxs)(v.Card,{children:[(0,a.jsx)(v.CardHeader,{children:(0,a.jsx)(v.CardTitle,{children:"Informações"})}),(0,a.jsxs)(v.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(Q,{label:"Cliente",value:C.cliente_nome,onSave:async e=>{await c(f,"cliente_nome",e),await P()}}),(0,a.jsx)(Q,{label:"Responsável",value:C.responsavel,onSave:async e=>{await c(f,"responsavel",e),await P()}}),(0,a.jsx)(Q,{label:"Data de Solicitação",value:C.data_solicitacao,type:"date",onSave:async e=>{await c(f,"data_solicitacao",e||null),await P()}}),(0,a.jsx)(Q,{label:"Prazo",value:C.prazo,type:"date",onSave:async e=>{await c(f,"prazo",e||null),await P()}}),(0,a.jsx)(Q,{label:"Data de Entrega",value:C.data_entrega,type:"date",onSave:async e=>{await c(f,"data_entrega",e||null),await P()}}),(0,a.jsx)(Q,{label:"Data de Pagamento",value:C.data_pagamento,type:"date",onSave:async e=>{await c(f,"data_pagamento",e||null),await P()}}),(0,a.jsx)(Q,{label:"Data Fim de Contrato",value:C.data_fim_contrato,type:"date",onSave:async e=>{await c(f,"data_fim_contrato",e||null),await P()}})]}),(0,a.jsx)("div",{className:"pt-4 border-t",children:(0,a.jsx)(Q,{label:"Observações",value:C.observacoes,type:"textarea",onSave:async e=>{await c(f,"observacoes",e||null),await P()}})})]})]}),(0,a.jsxs)(v.Card,{children:[(0,a.jsx)(v.CardHeader,{children:(0,a.jsxs)(v.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(x.FileText,{className:"h-5 w-5"}),"Arquivos"]})}),(0,a.jsxs)(v.CardContent,{className:"space-y-4",children:[(0,a.jsx)(m.FileUpload,{onUpload:q,maxSize:10}),k.length>0?(0,a.jsx)("div",{className:"space-y-2 mt-4",children:k.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(Q,{label:"",value:String(e.nome||""),onSave:async a=>{await d(String(e.id||""),{nome:a}),await P()}})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["string"==typeof e.storage_url&&e.storage_url&&(0,a.jsx)(h.Button,{variant:"ghost",size:"icon",onClick:()=>window.open(String(e.storage_url),"_blank"),children:(0,a.jsx)(I.Download,{className:"h-4 w-4"})}),(0,a.jsx)(h.Button,{variant:"ghost",size:"icon",onClick:async()=>{confirm("Tem certeza que deseja excluir este arquivo?")&&(await (0,u.deleteArquivoComStorage)(String(e.id||"")),await P())},children:(0,a.jsx)(H.Trash2,{className:"h-4 w-4 text-destructive"})})]})]},String(e.id||"")))}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Arraste arquivos para a área acima para fazer upload"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(_,{onSearch:(e,a)=>{console.log("Busca:",e,a)},demandaId:f}),k.map(e=>{let t;return(0,a.jsxs)(v.Card,{children:[(0,a.jsx)(v.CardHeader,{children:(0,a.jsx)(v.CardTitle,{className:"text-base",children:String(e.nome||"")})}),(0,a.jsxs)(v.CardContent,{className:"space-y-4",children:[(0,a.jsx)(L,{arquivoId:String(e.id||""),arquivoNome:String(e.nome||""),storageUrl:e.storage_url?String(e.storage_url):void 0}),(t=e.resumo_ia)&&"string"==typeof t?(0,a.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-3",children:t}):null]})]},String(e.id||""))})]})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,a.jsx)(x.FileText,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Demanda não encontrada"})]})}e.s(["default",()=>Z],77472)}]);